language: php
php:
  - 5.4
  - 5.3

env:
  - JVERSION_TEST=3.x

before_script:
  - pear channel-discover pear.phpunit.de
  - pear channel-discover pear.symfony-project.com
  - pear install phpunit/DbUnit
  - mysql -e 'create database fof_test;'
  - mysql -e "GRANT ALL PRIVILEGES ON fof_test TO 'travis'@'127.0.0.1'";
  - mysql -e "GRANT ALL PRIVILEGES ON fof_test TO 'travis'@'localhost'";
  - if [[ "$JVERSION_TEST" == "2.5" ]]; then cp tests/environments/2.5/joomla.sql joomla.sql; fi
  - if [[ "$JVERSION_TEST" == "3.x" ]]; then cp tests/environments/3.x/joomla.sql joomla.sql; fi
  - mysql fof_test < joomla.sql
  - cp build/templates/include.php fof/include.php

notifications:
  email: false

script: phpunit --bootstrap=tests/unit/bootstrap.php tests